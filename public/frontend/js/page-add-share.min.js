!function(e){"use strict";new(Backbone.View.extend({el:"#avt-page-share",formClassError:"md-input-danger",events:{"submit #avt-form-share":"handleForm","click .atl-manage-share-delete-js":"removeShare","click .atl-action-apply-js":"actionManage"},errorFormTpl:_.template('<div class="uk-notify-message <%= classes %>">                                        <a class="uk-close"></a>                                        <div>                                           <%= message %>                                        </div>                                    </div>'),initialize:function(){var a=this;e(window).load(function(){var t=e(".atl-notify-js",a.el).attr("data-notify");if(t){var r=a.errorFormTpl({message:t,classes:"uk-notify-message-success"});e(".atl-notify-js",a.el).html(r).show(),setTimeout(function(){e(".atl-notify-js",a.el).fadeOut()},3e3)}}),AVTLIB.checkAll(this.el)},handleForm:function(a){var t=this,r=e(".avt-required-js",this.el),s=new Array;return e.each(r,function(a,r){0===e(r).val().length?(e(r).addClass(t.formClassError),s.push(a)):(e(r).removeClass(t.formClassError),s.splice(a,1))}),0===s.length&&(this.handleShare(a),!1)},handleShare:function(a){var t={formData:e("#avt-form-share",this.el).serialize()},r=this;altair_helpers.content_preloader_show(),e.ajax({url:AVTDATA.SITE_URL+"/validate-share",type:"POST",data:t,success:function(a){altair_helpers.content_preloader_hide();var t=JSON.parse(a);if(!1===t.status){var s="";e.each(t.message,function(e,a){s+=r.errorFormTpl({message:a,classes:"uk-notify-message-danger"})}),e(".atl-notify-js",r.el).html(s).show(),setTimeout(function(){e(".atl-notify-js",r.el).fadeOut()},3e3)}else window.location=location.href=AVTDATA.SITE_URL+"/edit-share/"+t.id}})},removeShare:function(a){var t=e(a.currentTarget).attr("data-id");return UIkit.modal.confirm("Are you sure?",function(){var r={id:t};e.post(AVTDATA.SITE_URL+"/delete-share",r,function(t){e(a.currentTarget).closest("tr").remove(),UIkit.modal.alert("Delete Success!")})}),!1},actionManage:function(a){var t=e(a.currentTarget).closest(".atl-action-manage").find("select[name=atl-action-manage]").val(),r=new Array;if("delete"==t){altair_helpers.content_preloader_show(),e(".atl-checkbox-child-js",this.el).each(function(){this.checked&&r.push(e(this).val())});var s={id:r};e.post(AVTDATA.SITE_URL+"/delete-share",s,function(a){var t=JSON.parse(a);e.each(r,function(a,t){e(".atl-share-item-"+t).remove()}),altair_helpers.content_preloader_hide(),t.status?UIkit.modal.alert("Delete Success!"):UIkit.modal.alert("Delete False!")})}else UIkit.modal.alert("Please choose Action!")}}))}(jQuery);