!function(t){"use strict";new(Backbone.View.extend({el:".pita-page-up-share",events:{"change #pita-share-number":"changePacket","click .pita-start-action":"startAction"},errorFormTpl:_.template('<div class="uk-notify-message <%= classes %>">                                        <a class="uk-close"></a>                                        <div>                                           <%= message %>                                        </div>                                    </div>'),initialize:function(){this.changePacket()},changePacket:function(){var a={id:t("#pita-share-number",this.el).val()};t(".pita-start-action").show(),t.post(AVTDATA.SITE_URL+"/get-up-share",a,function(a){var e=JSON.parse(a);t(".avt-message-limit").text(""),t(".pita-start-action").show(),t(".pita-setinteval").val(e.numberS),t(".avt_total_share").val(e.total),e.total<1&&(t(".pita-start-action").hide(),t(".avt-message-limit").text("Đã hết lượt sử dụng, vui lòng mua thêm...."))})},startAction:function(){var a=this,e=t(".avt_share_number").val(),s=t(".avt_total_share").val();if(parseInt(e)<parseInt(s)){t(".avt-has-filter").attr("data-start",0),t(".avt-has-filter").text("0"),t(".avt-total-token-check-bar").css("width","1%"),t(".pita-start-action").hide(),t(".avt-message-limit").text("Đang chạy tools ...."),t(".avt-filter-token-live").show();var i=t(".pita-setinteval").val();t(".avt-total-token-check").attr("data-total",e),t(".avt-total-token-check").text(e+" Share ");var r=t(".avt-has-filter").attr("data-start"),o=t(".avt-total-token-check").attr("data-total");a.ajaxAction(r,1,o,i)}else{t(".avt-filter-token-live").hide();var n=a.errorFormTpl({message:"Vui lòng điền số lượt hoặc số lượt không đủ",classes:"uk-notify-message-danger"});t(".atl-notify-js",a.el).html(n).show(),setTimeout(function(){t(".atl-notify-js",a.el).fadeOut()},3e3)}},ajaxAction:function(a=0,e=1,s=0,i=2e3){var r=this,o={type:"upShare",start:a,limit:e,objectId:t(".pita-id-post").val(),id:t("#pita-share-number").val()};setTimeout(function(){t.post(AVTDATA.SITE_URL+"/ajax-tool-action",o,function(a){var o=JSON.parse(a);t(".avt-has-filter").attr("data-start",o.start),t(".avt-has-filter").text(o.start);var n=o.start/s*100;t(".avt-total-token-check-bar").css("width",n+"%"),t(".avt-c-token-live").text(o.tokenLive),t(".avt-c-token-die").text(o.tokenDie);var l=t(".avt_total_share").val();t(".avt_total_share").val(l-1),o.start<s?r.ajaxAction(o.start,e,s,i):(t(".avt-message-limit").text(""),t(".pita-start-action").show())})},i)}}))}(jQuery);