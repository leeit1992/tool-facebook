!function(t){"use strict";new(Backbone.View.extend({el:"#page-manage-acc-fb",events:{"submit #atl-form-file":"uploadFile","click .avt-auto-add-acc-js":"autoAccFb"},errorFormTpl:_.template('<div class="uk-notify-message <%= classes %>">                                        <a class="uk-close"></a>                                        <div>                                           <%= message %>                                        </div>                                    </div>'),initialize:function(){},uploadFile:function(){var a=this,e=t("input[name=atl-upload-file]").prop("files")[0],s=e.type,o=["text/plain","application/msword"];if(s==o[0]||s==o[1]){var i=new FormData;i.append("file",e),t.ajax({url:AVTDATA.SITE_URL+"/upload-acc-fb",type:"POST",data:i,contentType:!1,processData:!1,success:function(e){var s=JSON.parse(e);if(s.data){var o=a.errorFormTpl({message:"Upload file thành công và bắt đầu tự động lấy token.",classes:"uk-notify-message-success"});t(".atl-notify-js",a.el).html(o).show(),setTimeout(function(){t(".atl-notify-js",a.el).fadeOut(),t(".avt-filter-token-live").show();var e=t(".avt-has-filter").attr("data-start");t(".avt-total-token-check").attr("data-total",s.data),t(".avt-total-token-check").text(s.data),a.ajaxAction(e,1,s.data)},2e3),t(".avt-btn-auto",a.el).show()}}})}else{var l=a.errorFormTpl({message:"File sai định dạng",classes:"uk-notify-message-danger"});t(".atl-notify-js",a.el).html(l).show(),setTimeout(function(){t(".atl-notify-js",a.el).fadeOut()},3e3)}return!1},autoAccFb:function(){var a=this,e={abc:"123"};t.ajax({url:AVTDATA.SITE_URL+"/auto-acc-fb",type:"POST",data:e,success:function(e){if(!0===JSON.parse(e).status){s=a.errorFormTpl({message:"Upload file thành công",classes:"uk-notify-message-success"});t(".atl-notify-js",a.el).html(s).show(),setTimeout(function(){t(".atl-notify-js",a.el).fadeOut()},3e3),t(".avt-btn-auto",a.el).show()}else{var s=a.errorFormTpl({message:"Có lỗi xảy ra",classes:"uk-notify-message-danger"});t(".atl-notify-js",a.el).html(s).show(),setTimeout(function(){t(".atl-notify-js",a.el).fadeOut()},3e3)}}})},ajaxAction:function(a=0,e=1,s=0){var o=this,i={start:a,limit:e};t.post(AVTDATA.SITE_URL+"/auto-acc-fb",i,function(a){var i=JSON.parse(a);t(".avt-has-filter").attr("data-start",i.start),t(".avt-has-filter").text(i.start);var l=i.start/s*100;t(".avt-total-token-check-bar").css("width",l+"%"),t(".avt-c-token-live").text(i.tokenLive),t(".avt-c-token-die").text(i.tokenDie),i.start<s?o.ajaxAction(i.start,e,s):(t(".avt-message-limit").text(""),t(".pita-start-action").show())})}}))}(jQuery);